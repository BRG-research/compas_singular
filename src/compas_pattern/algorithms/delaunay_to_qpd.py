from compas.datastructures.mesh import Mesh

from compas.topology import delaunay_from_points

from compas_pattern.datastructures.mesh import face_circle

__author__     = ['Robin Oval']
__copyright__  = 'Copyright 2014, Block Research Group - ETH Zurich'
__license__    = 'MIT License'
__email__      = 'oval@arch.ethz.ch'


__all__ = [
    'delaunay_to_patch_decompostion',
]

def delaunay_to_patch_decompostion(delaunay_mesh):
    """Construct a patch decomposition from a Delaunay mesh.

    Parameters
    ----------
    delaunay_mesh : Mesh
        Delaunay mesh.

    Returns
    -------
    patch_decomposition: list, None
        List of polylines as lists of vertices forming the patch decomposition.
        Return None if input mesh is not a trimesh.

    Raises
    ------
    -

    """

    # return None if not a trimesh
    if not delaunay_mesh.is_trimesh():
        return None

    # collect 3-neighbour and 1-neighbour singularities as dictionary {fkey: nb neighbour}
    # collect reference points for polylines as dictionary {fkey: ref point}
    # the reference point is the circumcentre except for 1-neighbour singularities that is their 2-valency vertex
    singularities = {}
    reference_points = {}
    for fkey in delaunay_mesh.faces():
        nb_nbrs = len(delaunay_mesh.face_neighbours(fkey))
        if nb_nbrs == 3:
            singularities[fkey] = 3 
            reference_points[fkey] = face_circle(delaunay_mesh,fkey)[0]
        elif nb_nbrs == 1:
            singularities[fkey] = 1
            # find vertex with no other adjacent faces, i.e. with valency two
            for vkey in delaunay_mesh.face_vertices(fkey):
                if delaunay_mesh.vertex_degree(vkey) == 2:
                    reference_points[fkey] = delaunay_mesh.vertex_coordinates(vkey)
                    break
        else:
            reference_points[fkey] = face_circle(delaunay_mesh,fkey)[0]


    # collect branch paths that span from one singularity to another as series of faces
    branch_paths = []
    for singularity in singularities:
        for nbr in delaunay_mesh.face_neighbours(singularity):
            # start a potential new branch based on a singularity u and a neighbour v
            branch_path = []
            u, v = singularity, nbr
            branch_path = [u, v]
            count = delaunay_mesh.number_of_faces()
            end_loop = False
            # end loop only if reaches another singularity
            while not end_loop and count > 0:
                count -= 1
                if v not in singularities:
                    face_nbrs = delaunay_mesh.face_neighbours(v)
                    w = face_nbrs[face_nbrs.index(u) - 1]
                    branch_path.append(w)
                    u, v = v, w
                else:
                    end_loop = True
            # avoid duplicates by adding only one branch direction using following exclusion rules:
            # if not loop, add if first key smaller than last key
            # if loop, add if second key is smaller than second last key
            # PRUNING: do not add if the branch starts or ends from a 1-neighbour face 
            if branch_path[0] < branch_path[-1] or (branch_path[0] == branch_path[-1] and branch_path[1] < branch_path[-2]):
                if singularities[branch_path[0]] == 3 and singularities[branch_path[-1]] == 3:
                    branch_paths.append(branch_path)

    # create polylines by converting paths of faces into series of reference points
    medial_branches = [[reference_points[fkey] for fkey in branch_path] for branch_path in branch_paths]
    
    # GRAFTING
    for singularity in singularities:
        if singularities[singularity] == 3:
            for vkey in delaunay_mesh.face_vertices(singularity):
                medial_branches.append([reference_points[singularity], delaunay_mesh.vertex_coordinates(vkey)])

    return medial_branches


# ==============================================================================
# Main
# ==============================================================================

if __name__ == '__main__':

    import compas

    vertices = [[23.870672225952148, 1.0283968448638916, 0.0], [23.870672225952148, 1.327247142791748, 0.0], [23.870672225952148, 1.626097559928894, 0.0], [23.870672225952148, 1.9249478578567505, 0.0], [23.870672225952148, 2.2237982749938965, 0.0], [23.870672225952148, 2.522648572921753, 0.0], [23.870672225952148, 2.8214988708496094, 0.0], [23.870672225952148, 3.120349407196045, 0.0], [23.870672225952148, 3.4191997051239014, 0.0], [23.870672225952148, 3.718050003051758, 0.0], [23.870672225952148, 4.016900539398193, 0.0], [23.870672225952148, 4.315750598907471, 0.0], [23.870672225952148, 4.614601135253906, 0.0], [23.870672225952148, 4.913451194763184, 0.0], [23.870672225952148, 5.212301731109619, 0.0], [23.870672225952148, 5.511152267456055, 0.0], [23.870672225952148, 5.810002326965332, 0.0], [23.870672225952148, 6.108852863311768, 0.0], [23.870672225952148, 6.407703399658203, 0.0], [23.870672225952148, 6.7065534591674805, 0.0], [23.870672225952148, 7.005403995513916, 0.0], [23.870672225952148, 7.304254055023193, 0.0], [23.870672225952148, 7.603104591369629, 0.0], [23.870672225952148, 7.9019551277160645, 0.0], [23.870672225952148, 8.2008056640625, 0.0], [23.870672225952148, 8.499655723571777, 0.0], [23.870672225952148, 8.798505783081055, 0.0], [23.870672225952148, 9.097356796264648, 0.0], [23.870672225952148, 9.396206855773926, 0.0], [23.870672225952148, 9.695056915283203, 0.0], [23.870672225952148, 9.993907928466797, 0.0], [23.870672225952148, 10.292757987976074, 0.0], [23.870672225952148, 10.591608047485352, 0.0], [23.870672225952148, 10.890458106994629, 0.0], [23.870672225952148, 11.189309120178223, 0.0], [23.870672225952148, 11.4881591796875, 0.0], [23.870672225952148, 11.787009239196777, 0.0], [23.870672225952148, 12.085860252380371, 0.0], [23.870672225952148, 12.384710311889648, 0.0], [23.870672225952148, 12.683560371398926, 0.0], [23.870672225952148, 12.98241138458252, 0.0], [23.870672225952148, 13.281261444091797, 0.0], [23.870672225952148, 13.580111503601074, 0.0], [23.870672225952148, 13.878962516784668, 0.0], [23.870672225952148, 14.177812576293945, 0.0], [23.870672225952148, 14.476662635803223, 0.0], [23.870672225952148, 14.7755126953125, 0.0], [23.870672225952148, 15.074363708496094, 0.0], [23.870672225952148, 15.373213768005371, 0.0], [23.870672225952148, 15.672063827514648, 0.0], [23.870672225952148, 15.970914840698242, 0.0], [23.870672225952148, 16.269765853881836, 0.0], [23.870672225952148, 16.568614959716797, 0.0], [23.870672225952148, 16.867465972900391, 0.0], [23.870672225952148, 17.166315078735352, 0.0], [23.573755264282227, 17.166315078735352, 0.0], [23.276838302612305, 17.166315078735352, 0.0], [22.979921340942383, 17.166315078735352, 0.0], [22.683006286621094, 17.166315078735352, 0.0], [22.386089324951172, 17.166315078735352, 0.0], [22.08917236328125, 17.166315078735352, 0.0], [21.792255401611328, 17.166315078735352, 0.0], [21.495338439941406, 17.166315078735352, 0.0], [21.198423385620117, 17.166315078735352, 0.0], [20.901506423950195, 17.166315078735352, 0.0], [20.604589462280273, 17.166315078735352, 0.0], [20.307672500610352, 17.166315078735352, 0.0], [20.01075553894043, 17.166315078735352, 0.0], [19.713838577270508, 17.166315078735352, 0.0], [19.416923522949219, 17.166315078735352, 0.0], [19.120006561279297, 17.166315078735352, 0.0], [18.823089599609375, 17.166315078735352, 0.0], [18.526172637939453, 17.166315078735352, 0.0], [18.229255676269531, 17.166315078735352, 0.0], [17.932340621948242, 17.166315078735352, 0.0], [17.63542366027832, 17.166315078735352, 0.0], [17.3385066986084, 17.166315078735352, 0.0], [17.041589736938477, 17.166315078735352, 0.0], [16.744672775268555, 17.166315078735352, 0.0], [16.447755813598633, 17.166315078735352, 0.0], [16.150840759277344, 17.166315078735352, 0.0], [15.853923797607422, 17.166315078735352, 0.0], [15.5570068359375, 17.166315078735352, 0.0], [15.260089874267578, 17.166315078735352, 0.0], [14.963173866271973, 17.166315078735352, 0.0], [14.666256904602051, 17.166315078735352, 0.0], [14.369339942932129, 17.166315078735352, 0.0], [14.072423934936523, 17.166315078735352, 0.0], [13.775506973266602, 17.166315078735352, 0.0], [13.478590965270996, 17.166315078735352, 0.0], [13.181674003601074, 17.166315078735352, 0.0], [12.884757041931152, 17.166315078735352, 0.0], [12.587841033935547, 17.166315078735352, 0.0], [12.290924072265625, 17.166315078735352, 0.0], [11.994007110595703, 17.166315078735352, 0.0], [11.697091102600098, 17.166315078735352, 0.0], [11.400174140930176, 17.166315078735352, 0.0], [11.103257179260254, 17.166315078735352, 0.0], [10.806341171264648, 17.166315078735352, 0.0], [10.509424209594727, 17.166315078735352, 0.0], [10.212507247924805, 17.166315078735352, 0.0], [9.915591239929199, 17.166315078735352, 0.0], [9.618674278259277, 17.166315078735352, 0.0], [9.321758270263672, 17.166315078735352, 0.0], [9.02484130859375, 17.166315078735352, 0.0], [8.727924346923828, 17.166315078735352, 0.0], [8.431008338928223, 17.166315078735352, 0.0], [8.134091377258301, 17.166315078735352, 0.0], [7.837174892425537, 17.166315078735352, 0.0], [7.540257930755615, 17.166315078735352, 0.0], [7.243341445922852, 17.166315078735352, 0.0], [6.946424961090088, 17.166315078735352, 0.0], [6.649508476257324, 17.166315078735352, 0.0], [6.352591514587402, 17.166315078735352, 0.0], [6.055675029754639, 17.166315078735352, 0.0], [5.758758544921875, 17.166315078735352, 0.0], [5.461842060089111, 17.166315078735352, 0.0], [5.1649250984191895, 17.166315078735352, 0.0], [4.868008613586426, 17.166315078735352, 0.0], [4.571092128753662, 17.166315078735352, 0.0], [4.27417516708374, 17.166315078735352, 0.0], [3.9772586822509766, 17.166315078735352, 0.0], [3.680342197418213, 17.166315078735352, 0.0], [3.38342547416687, 17.166315078735352, 0.0], [3.0865089893341064, 17.166315078735352, 0.0], [2.7895922660827637, 17.166315078735352, 0.0], [2.492675542831421, 17.166315078735352, 0.0], [2.1957590579986572, 17.166315078735352, 0.0], [1.898842453956604, 17.166315078735352, 0.0], [1.6019258499145508, 17.166315078735352, 0.0], [1.6019258499145508, 1.0283968448638916, 0.0], [1.898842453956604, 1.0283968448638916, 0.0], [2.1957590579986572, 1.0283968448638916, 0.0], [2.492675542831421, 1.0283968448638916, 0.0], [2.7895922660827637, 1.0283968448638916, 0.0], [3.0865089893341064, 1.0283968448638916, 0.0], [3.38342547416687, 1.0283968448638916, 0.0], [3.680342197418213, 1.0283968448638916, 0.0], [3.9772586822509766, 1.0283968448638916, 0.0], [4.27417516708374, 1.0283968448638916, 0.0], [4.571092128753662, 1.0283968448638916, 0.0], [4.868008613586426, 1.0283968448638916, 0.0], [5.1649250984191895, 1.0283968448638916, 0.0], [5.461842060089111, 1.0283968448638916, 0.0], [5.758758544921875, 1.0283968448638916, 0.0], [6.055675029754639, 1.0283968448638916, 0.0], [6.352591514587402, 1.0283968448638916, 0.0], [6.649508476257324, 1.0283968448638916, 0.0], [6.946424961090088, 1.0283968448638916, 0.0], [7.243341445922852, 1.0283968448638916, 0.0], [7.540257930755615, 1.0283968448638916, 0.0], [7.837174892425537, 1.0283968448638916, 0.0], [8.134091377258301, 1.0283968448638916, 0.0], [8.431008338928223, 1.0283968448638916, 0.0], [8.727924346923828, 1.0283968448638916, 0.0], [9.02484130859375, 1.0283968448638916, 0.0], [9.321758270263672, 1.0283968448638916, 0.0], [9.618674278259277, 1.0283968448638916, 0.0], [9.915591239929199, 1.0283968448638916, 0.0], [10.212507247924805, 1.0283968448638916, 0.0], [10.509424209594727, 1.0283968448638916, 0.0], [10.806341171264648, 1.0283968448638916, 0.0], [11.103257179260254, 1.0283968448638916, 0.0], [11.400174140930176, 1.0283968448638916, 0.0], [11.697091102600098, 1.0283968448638916, 0.0], [11.994007110595703, 1.0283968448638916, 0.0], [12.290924072265625, 1.0283968448638916, 0.0], [12.587841033935547, 1.0283968448638916, 0.0], [12.884757041931152, 1.0283968448638916, 0.0], [13.181674003601074, 1.0283968448638916, 0.0], [13.478590965270996, 1.0283968448638916, 0.0], [13.775506973266602, 1.0283968448638916, 0.0], [14.072423934936523, 1.0283968448638916, 0.0], [14.369339942932129, 1.0283968448638916, 0.0], [14.666256904602051, 1.0283968448638916, 0.0], [14.963173866271973, 1.0283968448638916, 0.0], [15.260089874267578, 1.0283968448638916, 0.0], [15.5570068359375, 1.0283968448638916, 0.0], [15.853923797607422, 1.0283968448638916, 0.0], [16.150840759277344, 1.0283968448638916, 0.0], [16.447755813598633, 1.0283968448638916, 0.0], [16.744672775268555, 1.0283968448638916, 0.0], [17.041589736938477, 1.0283968448638916, 0.0], [17.3385066986084, 1.0283968448638916, 0.0], [17.63542366027832, 1.0283968448638916, 0.0], [17.932340621948242, 1.0283968448638916, 0.0], [18.229255676269531, 1.0283968448638916, 0.0], [18.526172637939453, 1.0283968448638916, 0.0], [18.823089599609375, 1.0283968448638916, 0.0], [19.120006561279297, 1.0283968448638916, 0.0], [19.416923522949219, 1.0283968448638916, 0.0], [19.713838577270508, 1.0283968448638916, 0.0], [20.01075553894043, 1.0283968448638916, 0.0], [20.307672500610352, 1.0283968448638916, 0.0], [20.604589462280273, 1.0283968448638916, 0.0], [20.901506423950195, 1.0283968448638916, 0.0], [21.198423385620117, 1.0283968448638916, 0.0], [21.495338439941406, 1.0283968448638916, 0.0], [21.792255401611328, 1.0283968448638916, 0.0], [22.08917236328125, 1.0283968448638916, 0.0], [22.386089324951172, 1.0283968448638916, 0.0], [22.683006286621094, 1.0283968448638916, 0.0], [22.979921340942383, 1.0283968448638916, 0.0], [23.276838302612305, 1.0283968448638916, 0.0], [23.573755264282227, 1.0283968448638916, 0.0], [1.6019258499145508, 16.867465972900391, 0.0], [1.6019258499145508, 16.568614959716797, 0.0], [1.6019258499145508, 16.269765853881836, 0.0], [1.6019258499145508, 15.970914840698242, 0.0], [1.6019258499145508, 15.672063827514648, 0.0], [1.6019258499145508, 15.373213768005371, 0.0], [1.6019258499145508, 15.074363708496094, 0.0], [1.6019258499145508, 14.7755126953125, 0.0], [1.6019258499145508, 14.476662635803223, 0.0], [1.6019258499145508, 14.177812576293945, 0.0], [1.6019258499145508, 13.878962516784668, 0.0], [1.6019258499145508, 13.580111503601074, 0.0], [1.6019258499145508, 13.281261444091797, 0.0], [1.6019258499145508, 12.98241138458252, 0.0], [1.6019258499145508, 12.683560371398926, 0.0], [1.6019258499145508, 12.384710311889648, 0.0], [1.6019258499145508, 12.085860252380371, 0.0], [1.6019258499145508, 11.787009239196777, 0.0], [1.6019258499145508, 11.4881591796875, 0.0], [1.6019258499145508, 11.189309120178223, 0.0], [1.6019258499145508, 10.890458106994629, 0.0], [1.6019258499145508, 10.591608047485352, 0.0], [1.6019258499145508, 10.292757987976074, 0.0], [1.6019258499145508, 9.993907928466797, 0.0], [1.6019258499145508, 9.695056915283203, 0.0], [1.6019258499145508, 9.396206855773926, 0.0], [1.6019258499145508, 9.097356796264648, 0.0], [1.6019258499145508, 8.798505783081055, 0.0], [1.6019258499145508, 8.499655723571777, 0.0], [1.6019258499145508, 8.2008056640625, 0.0], [1.6019258499145508, 7.9019551277160645, 0.0], [1.6019258499145508, 7.603104591369629, 0.0], [1.6019258499145508, 7.304254055023193, 0.0], [1.6019258499145508, 7.005403995513916, 0.0], [1.6019258499145508, 6.7065534591674805, 0.0], [1.6019258499145508, 6.407703399658203, 0.0], [1.6019258499145508, 6.108852863311768, 0.0], [1.6019258499145508, 5.810002326965332, 0.0], [1.6019258499145508, 5.511152267456055, 0.0], [1.6019258499145508, 5.212301731109619, 0.0], [1.6019258499145508, 4.913451194763184, 0.0], [1.6019258499145508, 4.614601135253906, 0.0], [1.6019258499145508, 4.315750598907471, 0.0], [1.6019258499145508, 4.016900539398193, 0.0], [1.6019258499145508, 3.718050003051758, 0.0], [1.6019258499145508, 3.4191997051239014, 0.0], [1.6019258499145508, 3.120349407196045, 0.0], [1.6019258499145508, 2.8214988708496094, 0.0], [1.6019258499145508, 2.522648572921753, 0.0], [1.6019258499145508, 2.2237982749938965, 0.0], [1.6019258499145508, 1.9249478578567505, 0.0], [1.6019258499145508, 1.626097559928894, 0.0], [1.6019258499145508, 1.327247142791748, 0.0], [6.417330265045166, 15.810799598693848, 0.0], [6.706697463989258, 15.769120216369629, 0.0], [6.986737251281738, 15.685272216796875, 0.0], [7.2498297691345215, 15.557991027832031, 0.0], [7.486101150512695, 15.386123657226563, 0.0], [7.6830596923828125, 15.17048454284668, 0.0], [7.8274149894714355, 14.916702270507813, 0.0], [7.913899898529053, 14.637681007385254, 0.0], [7.946983337402344, 14.347330093383789, 0.0], [7.9304704666137695, 14.055526733398438, 0.0], [7.865671634674072, 13.77054500579834, 0.0], [7.751611709594727, 13.501546859741211, 0.0], [7.586338520050049, 13.260772705078125, 0.0], [7.37071418762207, 13.063990592956543, 0.0], [7.116407871246338, 12.920380592346191, 0.0], [6.838321208953857, 12.83082389831543, 0.0], [6.548361778259277, 12.79475212097168, 0.0], [6.256702423095703, 12.81231689453125, 0.0], [5.973669052124023, 12.884683609008789, 0.0], [5.711227893829346, 13.012834548950195, 0.0], [5.4813971519470215, 13.193136215209961, 0.0], [5.288417339324951, 13.41262149810791, 0.0], [5.132203102111816, 13.6597261428833, 0.0], [5.01242733001709, 13.926443099975586, 0.0], [4.930136203765869, 14.206998825073242, 0.0], [4.888735771179199, 14.496382713317871, 0.0], [4.894959449768066, 14.788533210754395, 0.0], [4.959632396697998, 15.073250770568848, 0.0], [5.095595359802246, 15.331140518188477, 0.0], [5.303287029266357, 15.535720825195313, 0.0], [5.557486057281494, 15.679327964782715, 0.0], [5.835731506347656, 15.768580436706543, 0.0], [6.124969005584717, 15.81095027923584, 0.0], [15.202535629272461, 15.066057205200195, 0.0], [15.490262985229492, 15.113187789916992, 0.0], [15.781623840332031, 15.107058525085449, 0.0], [16.063968658447266, 15.036079406738281, 0.0], [16.314128875732422, 14.888094902038574, 0.0], [16.501409530639648, 14.665922164916992, 0.0], [16.616016387939453, 14.3983793258667, 0.0], [16.659954071044922, 14.11054515838623, 0.0], [16.629161834716797, 13.821172714233398, 0.0], [16.515018463134766, 13.553817749023438, 0.0], [16.327840805053711, 13.330973625183105, 0.0], [16.0916748046875, 13.160452842712402, 0.0], [15.824740409851074, 13.043540000915527, 0.0], [15.539915084838867, 12.981852531433105, 0.0], [15.248571395874023, 12.979700088500977, 0.0], [14.96446704864502, 13.043552398681641, 0.0], [14.705031394958496, 13.175764083862305, 0.0], [14.482578277587891, 13.363873481750488, 0.0], [14.306541442871094, 13.595962524414063, 0.0], [14.19214916229248, 13.863551139831543, 0.0], [14.167804718017578, 14.152719497680664, 0.0], [14.25995922088623, 14.427655220031738, 0.0], [14.439286231994629, 14.656758308410645, 0.0], [14.668210983276367, 14.837071418762207, 0.0], [14.926177978515625, 14.972978591918945, 0.0], [12.60972785949707, 15.424636840820312, 0.0], [12.56600284576416, 15.711464881896973, 0.0], [12.374147415161133, 15.929121017456055, 0.0], [12.095075607299805, 16.008501052856445, 0.0], [11.817388534545898, 15.92440128326416, 0.0], [11.629252433776855, 15.703522682189941, 0.0], [11.590396881103516, 15.415994644165039, 0.0], [11.713159561157227, 15.153102874755859, 0.0], [11.958563804626465, 14.998315811157227, 0.0], [12.248695373535156, 15.000775337219238, 0.0], [12.491439819335938, 15.159701347351074, 0.0], [20.443317413330078, 14.362689018249512, 0.0], [20.411426544189453, 14.636794090270996, 0.0], [20.236406326293945, 14.85014533996582, 0.0], [19.973823547363281, 14.935005187988281, 0.0], [19.707046508789063, 14.86443042755127, 0.0], [19.520774841308594, 14.660828590393066, 0.0], [19.474149703979492, 14.38884162902832, 0.0], [19.581972122192383, 14.1348237991333, 0.0], [19.81001091003418, 13.979424476623535, 0.0], [20.085865020751953, 13.971980094909668, 0.0], [20.321950912475586, 14.114855766296387, 0.0], [20.857063293457031, 10.983763694763184, 0.0], [20.791828155517578, 11.267285346984863, 0.0], [20.572402954101562, 11.458314895629883, 0.0], [20.2825984954834, 11.483885765075684, 0.0], [20.033111572265625, 11.334230422973633, 0.0], [19.919239044189453, 11.066513061523438, 0.0], [19.984474182128906, 10.782991409301758, 0.0], [20.203899383544922, 10.591961860656738, 0.0], [20.493703842163086, 10.566390991210937, 0.0], [20.743188858032227, 10.716046333312988, 0.0], [14.430209159851074, 6.998011589050293, 0.0], [14.398639678955078, 7.284449100494385, 0.0], [14.253294944763184, 7.53328275680542, 0.0], [14.019306182861328, 7.701486110687256, 0.0], [13.73713207244873, 7.759975910186768, 0.0], [13.455563545227051, 7.698638916015625, 0.0], [13.223286628723145, 7.528079986572266, 0.0], [13.080462455749512, 7.2777910232543945, 0.0], [13.051788330078125, 6.991048812866211, 0.0], [13.142221450805664, 6.717433929443359, 0.0], [13.336125373840332, 6.5042572021484375, 0.0], [13.599972724914551, 6.388378143310547, 0.0], [13.888141632080078, 6.389833927154541, 0.0], [14.15080451965332, 6.5083723068237305, 0.0], [14.342544555664063, 6.723496913909912, 0.0], [10.003128051757812, 12.266376495361328, 0.0], [10.296051025390625, 12.298140525817871, 0.0], [10.589098930358887, 12.328713417053223, 0.0], [10.882867813110352, 12.351099967956543, 0.0], [11.17738151550293, 12.357478141784668, 0.0], [11.471347808837891, 12.33937931060791, 0.0], [11.761406898498535, 12.288707733154297, 0.0], [12.042072296142578, 12.199849128723145, 0.0], [12.307651519775391, 12.072780609130859, 0.0], [12.553455352783203, 11.910743713378906, 0.0], [12.773406982421875, 11.715121269226074, 0.0], [12.958599090576172, 11.486445426940918, 0.0], [13.096514701843262, 11.226686477661133, 0.0], [13.17388916015625, 10.943027496337891, 0.0], [13.191258430480957, 10.64934253692627, 0.0], [13.157217025756836, 10.3569974899292, 0.0], [13.079198837280273, 10.073139190673828, 0.0], [12.962070465087891, 9.803037643432617, 0.0], [12.808133125305176, 9.55211067199707, 0.0], [12.61761474609375, 9.32778263092041, 0.0], [12.392584800720215, 9.138114929199219, 0.0], [12.139886856079102, 8.987176895141602, 0.0], [11.86782169342041, 8.874663352966309, 0.0], [11.583744049072266, 8.797090530395508, 0.0], [11.293060302734375, 8.74964714050293, 0.0], [10.999327659606934, 8.72751522064209, 0.0], [10.704740524291992, 8.726467132568359, 0.0], [10.410600662231445, 8.743002891540527, 0.0], [10.117652893066406, 8.774295806884766, 0.0], [9.826301574707031, 8.818074226379395, 0.0], [9.536887168884277, 8.873210906982422, 0.0], [9.250408172607422, 8.941930770874023, 0.0], [8.968672752380371, 9.027975082397461, 0.0], [8.69474983215332, 9.136227607727051, 0.0], [8.433989524841309, 9.273003578186035, 0.0], [8.195723533630371, 9.445749282836914, 0.0], [7.994990348815918, 9.660638809204102, 0.0], [7.85060453414917, 9.916571617126465, 0.0], [7.773412227630615, 10.200251579284668, 0.0], [7.7545247077941895, 10.493898391723633, 0.0], [7.783522129058838, 10.786827087402344, 0.0], [7.854898929595947, 11.072431564331055, 0.0], [7.9672088623046875, 11.344521522521973, 0.0], [8.122279167175293, 11.594595909118652, 0.0], [8.323949813842773, 11.808542251586914, 0.0], [8.569091796875, 11.97092342376709, 0.0], [8.84126091003418, 12.082880973815918, 0.0], [9.126505851745606, 12.156076431274414, 0.0], [9.417217254638672, 12.203695297241211, 0.0], [9.709938049316406, 12.237171173095703, 0.0], [16.223108291625977, 11.273386001586914, 0.0], [15.957926750183105, 11.143682479858398, 0.0], [15.703433990478516, 10.994315147399902, 0.0], [15.472227096557617, 10.811311721801758, 0.0], [15.281956672668457, 10.586377143859863, 0.0], [15.144904136657715, 10.325450897216797, 0.0], [15.058451652526855, 10.043559074401855, 0.0], [15.022706985473633, 9.750906944274902, 0.0], [15.045268058776855, 9.457145690917969, 0.0], [15.143289566040039, 9.179948806762695, 0.0], [15.332549095153809, 8.955685615539551, 0.0], [15.585501670837402, 8.805336952209473, 0.0], [15.866571426391602, 8.716388702392578, 0.0], [16.158157348632812, 8.67143726348877, 0.0], [16.452995300292969, 8.658546447753906, 0.0], [16.747907638549805, 8.670581817626953, 0.0], [17.041181564331055, 8.703941345214844, 0.0], [17.330698013305664, 8.761180877685547, 0.0], [17.612396240234375, 8.848932266235352, 0.0], [17.879470825195313, 8.974089622497559, 0.0], [18.122222900390625, 9.141427040100098, 0.0], [18.330204010009766, 9.350349426269531, 0.0], [18.496816635131836, 9.593623161315918, 0.0], [18.622531890869141, 9.860440254211426, 0.0], [18.707117080688477, 10.142999649047852, 0.0], [18.745332717895508, 10.435369491577148, 0.0], [18.72563362121582, 10.72931957244873, 0.0], [18.63014030456543, 11.007452964782715, 0.0], [18.448036193847656, 11.237964630126953, 0.0], [18.205423355102539, 11.404786109924316, 0.0], [17.931997299194336, 11.514960289001465, 0.0], [17.643686294555664, 11.577088356018066, 0.0], [17.349281311035156, 11.595071792602539, 0.0], [17.055662155151367, 11.567445755004883, 0.0], [16.769302368164063, 11.496547698974609, 0.0], [16.492603302001953, 11.393884658813477, 0.0], [19.822698593139648, 7.825503349304199, 0.0], [20.118898391723633, 7.852325916290283, 0.0], [20.416297912597656, 7.852565288543701, 0.0], [20.712362289428711, 7.824553489685059, 0.0], [21.003997802734375, 7.7664618492126465, 0.0], [21.287410736083984, 7.676523208618164, 0.0], [21.558036804199219, 7.55340576171875, 0.0], [21.810756683349609, 7.39682674407959, 0.0], [22.041881561279297, 7.2097859382629395, 0.0], [22.250026702880859, 6.997427940368652, 0.0], [22.434652328491211, 6.764303684234619, 0.0], [22.595539093017578, 6.514186859130859, 0.0], [22.732444763183594, 6.250170707702637, 0.0], [22.844877243041992, 5.974836826324463, 0.0], [22.931919097900391, 5.690457344055176, 0.0], [22.992431640625, 5.399279594421387, 0.0], [23.025600433349609, 5.1037373542785645, 0.0], [23.030986785888672, 4.806389808654785, 0.0], [23.0085391998291, 4.509840965270996, 0.0], [22.958589553833008, 4.216666221618652, 0.0], [22.881853103637695, 3.929335594177246, 0.0], [22.779394149780273, 3.6501355171203613, 0.0], [22.652496337890625, 3.381159543991089, 0.0], [22.501964569091797, 3.124666929244995, 0.0], [22.328062057495117, 2.8834235668182373, 0.0], [22.13072395324707, 2.6609718799591064, 0.0], [21.90986442565918, 2.461902379989624, 0.0], [21.665889739990234, 2.2920336723327637, 0.0], [21.400476455688477, 2.158235549926758, 0.0], [21.118324279785156, 2.064685106277466, 0.0], [20.826192855834961, 2.0094187259674072, 0.0], [20.529569625854492, 1.9884957075119019, 0.0], [20.23231315612793, 1.9975861310958862, 0.0], [19.936971664428711, 2.0327069759368896, 0.0], [19.64520263671875, 2.0905163288116455, 0.0], [19.358119964599609, 2.1683669090270996, 0.0], [19.076700210571289, 2.26470685005188, 0.0], [18.802358627319336, 2.379650115966797, 0.0], [18.53685188293457, 2.513723850250244, 0.0], [18.282308578491211, 2.667578935623169, 0.0], [18.041330337524414, 2.8418896198272705, 0.0], [17.817052841186523, 3.0371928215026855, 0.0], [17.613151550292969, 3.2536540031433105, 0.0], [17.433717727661133, 3.490762233734131, 0.0], [17.282915115356445, 3.7470102310180664, 0.0], [17.164125442504883, 4.019575595855713, 0.0], [17.0777530670166, 4.304103374481201, 0.0], [17.023147583007813, 4.596408367156982, 0.0], [16.999958038330078, 4.89286994934082, 0.0], [17.008272171020508, 5.190118312835693, 0.0], [17.048618316650391, 5.484724044799805, 0.0], [17.121891021728516, 5.77289342880249, 0.0], [17.229057312011719, 6.050225734710693, 0.0], [17.368949890136719, 6.312594413757324, 0.0], [17.5378360748291, 6.557333469390869, 0.0], [17.731756210327148, 6.782782554626465, 0.0], [17.946989059448242, 6.988006591796875, 0.0], [18.180240631103516, 7.172518253326416, 0.0], [18.428668975830078, 7.3360419273376465, 0.0], [18.689846038818359, 7.478334903717041, 0.0], [18.961666107177734, 7.599062442779541, 0.0], [19.242256164550781, 7.6977128982543945, 0.0], [19.529853820800781, 7.773536205291748, 0.0], [8.044731140136719, 4.487952709197998, 0.0], [8.337499618530273, 4.474418640136719, 0.0], [8.613127708435059, 4.373572826385498, 0.0], [8.84832763671875, 4.198300838470459, 0.0], [9.018368721008301, 3.9592559337615967, 0.0], [9.117463111877441, 3.6827282905578613, 0.0], [9.155096054077148, 3.3911125659942627, 0.0], [9.142436981201172, 3.0972042083740234, 0.0], [9.086095809936523, 2.8084425926208496, 0.0], [8.98534107208252, 2.5321104526519775, 0.0], [8.834023475646973, 2.280167579650879, 0.0], [8.623544692993164, 2.0758562088012695, 0.0], [8.356198310852051, 1.9569185972213745, 0.0], [8.063424110412598, 1.9397574663162231, 0.0], [7.7767181396484375, 2.0034942626953125, 0.0], [7.514258861541748, 2.1353304386138916, 0.0], [7.297474384307861, 2.3329644203186035, 0.0], [7.150300979614258, 2.5867903232574463, 0.0], [7.076215744018555, 2.8710367679595947, 0.0], [7.066478252410889, 3.164855718612671, 0.0], [7.111645221710205, 3.4554643630981445, 0.0], [7.205516338348389, 3.73421573638916, 0.0], [7.345287322998047, 3.992976427078247, 0.0], [7.531587600708008, 4.220328330993652, 0.0], [7.766673564910889, 4.396083354949951, 0.0], [3.1625289916992187, 7.011803150177002, 0.0], [3.409996747970581, 6.858595371246338, 0.0], [3.5700771808624268, 6.6114397048950195, 0.0], [3.6627862453460693, 6.331307888031006, 0.0], [3.6944308280944824, 6.037918567657471, 0.0], [3.6600914001464844, 5.744959354400635, 0.0], [3.5504021644592285, 5.471594333648682, 0.0], [3.353660821914673, 5.253683567047119, 0.0], [3.0826056003570557, 5.142025470733643, 0.0], [2.7885401248931885, 5.143962383270264, 0.0], [2.5166099071502686, 5.254324436187744, 0.0], [2.322768211364746, 5.474096298217773, 0.0], [2.229834794998169, 5.753243923187256, 0.0], [2.2240676879882813, 6.047952175140381, 0.0], [2.293043375015259, 6.33467435836792, 0.0], [2.4305007457733154, 6.595582485198975, 0.0], [2.6261706352233887, 6.816272258758545, 0.0], [2.8737027645111084, 6.975585460662842, 0.0], [6.086333751678467, 8.501288414001465, 0.0], [6.3806843757629395, 8.52837085723877, 0.0], [6.674741268157959, 8.496921539306641, 0.0], [6.960262298583984, 8.419189453125, 0.0], [7.235239028930664, 8.309529304504395, 0.0], [7.50139045715332, 8.179760932922363, 0.0], [7.760228633880615, 8.035967826843262, 0.0], [8.006876945495606, 7.872285842895508, 0.0], [8.230094909667969, 7.67818546295166, 0.0], [8.405999183654785, 7.441119194030762, 0.0], [8.491546630859375, 7.159701347351074, 0.0], [8.466330528259277, 6.865956783294678, 0.0], [8.361598014831543, 6.589699745178223, 0.0], [8.198062896728516, 6.343507289886475, 0.0], [7.983308792114258, 6.140592575073242, 0.0], [7.7278971672058105, 5.9918975830078125, 0.0], [7.447323799133301, 5.898556232452393, 0.0], [7.154607772827148, 5.855838298797607, 0.0], [6.85871696472168, 5.857685565948486, 0.0], [6.5657196044921875, 5.89926815032959, 0.0], [6.280605792999268, 5.978540897369385, 0.0], [6.008756160736084, 6.095401763916016, 0.0], [5.75682258605957, 6.250507354736328, 0.0], [5.533462047576904, 6.44439172744751, 0.0], [5.349459648132324, 6.675833702087402, 0.0], [5.216159820556641, 6.939662933349609, 0.0], [5.140821933746338, 7.225512981414795, 0.0], [5.127748489379883, 7.520747184753418, 0.0], [5.187102794647217, 7.8099365234375, 0.0], [5.330740451812744, 8.067336082458496, 0.0], [5.546084403991699, 8.269283294677734, 0.0], [5.804018974304199, 8.413578033447266, 0.0], [5.824294567108154, 11.825047492980957, 0.0], [5.816143035888672, 12.103715896606445, 0.0], [5.669749736785889, 12.340973854064941, 0.0], [5.42434024810791, 12.473249435424805, 0.0], [5.145671367645264, 12.465097427368164, 0.0], [4.908413410186768, 12.318704605102539, 0.0], [4.7761383056640625, 12.073294639587402, 0.0], [4.784289360046387, 11.794626235961914, 0.0], [4.93068265914917, 11.557368278503418, 0.0], [5.176092624664307, 11.425092697143555, 0.0], [5.454761028289795, 11.433243751525879, 0.0], [5.692019462585449, 11.57963752746582, 0.0], [12.554561614990234, 3.660460948944092, 0.0], [12.816205978393555, 3.53287935256958, 0.0], [13.081367492675781, 3.4133877754211426, 0.0], [13.368435859680176, 3.3970460891723633, 0.0], [13.64018440246582, 3.499675750732422, 0.0], [13.899890899658203, 3.6313869953155518, 0.0], [14.16909122467041, 3.7417280673980713, 0.0], [14.454751014709473, 3.7925362586975098, 0.0], [14.732933044433594, 3.720855712890625, 0.0], [14.932391166687012, 3.5124738216400146, 0.0], [15.029787063598633, 3.2400057315826416, 0.0], [15.011133193969727, 2.9515480995178223, 0.0], [14.886088371276855, 2.690178394317627, 0.0], [14.678643226623535, 2.488286018371582, 0.0], [14.404529571533203, 2.4024498462677, 0.0], [14.119958877563477, 2.456768274307251, 0.0], [13.851825714111328, 2.570059299468994, 0.0], [13.585488319396973, 2.687687635421753, 0.0], [13.306756973266602, 2.770230531692505, 0.0], [13.0177640914917, 2.7640292644500732, 0.0], [12.748368263244629, 2.655311346054077, 0.0], [12.49126148223877, 2.5186030864715576, 0.0], [12.222186088562012, 2.4082751274108887, 0.0], [11.934760093688965, 2.373976469039917, 0.0], [11.663878440856934, 2.4722774028778076, 0.0], [11.456781387329102, 2.6746304035186768, 0.0], [11.338749885559082, 2.9386680126190186, 0.0], [11.351509094238281, 3.2265586853027344, 0.0], [11.487334251403809, 3.4820287227630615, 0.0], [11.708833694458008, 3.6681792736053467, 0.0], [11.985589027404785, 3.752817392349243, 0.0], [12.275612831115723, 3.742030143737793, 0.0]]
    face_vertices = [[432, 508, 507], [432, 509, 508], [509, 432, 433], [433, 510, 509], [510, 433, 434], [510, 434, 511], [296, 75, 74], [75, 296, 295], [435, 511, 434], [511, 435, 449], [260, 110, 109], [260, 111, 110], [111, 260, 259], [601, 603, 602], [603, 601, 600], [600, 604, 603], [604, 599, 359], [604, 600, 599], [359, 605, 604], [345, 437, 344], [437, 345, 436], [605, 359, 360], [344, 439, 343], [438, 344, 437], [261, 109, 108], [109, 261, 260], [439, 344, 438], [360, 606, 605], [606, 360, 361], [440, 343, 439], [343, 440, 342], [262, 107, 106], [262, 108, 107], [108, 262, 261], [335, 442, 334], [266, 363, 267], [342, 442, 335], [441, 342, 440], [361, 607, 606], [607, 497, 496], [607, 498, 497], [607, 361, 498], [442, 342, 441], [334, 443, 299], [443, 334, 442], [496, 608, 607], [266, 364, 363], [364, 266, 323], [53, 55, 54], [608, 495, 494], [608, 496, 495], [299, 444, 300], [444, 299, 443], [323, 365, 364], [609, 494, 493], [300, 445, 301], [445, 300, 444], [494, 609, 608], [323, 366, 365], [301, 446, 302], [446, 301, 445], [302, 446, 447], [323, 367, 366], [367, 323, 324], [610, 180, 179], [491, 610, 492], [413, 303, 448], [448, 302, 447], [324, 368, 367], [302, 448, 303], [610, 493, 492], [493, 610, 609], [610, 491, 180], [179, 611, 610], [611, 178, 177], [611, 179, 178], [369, 324, 325], [324, 369, 368], [436, 449, 435], [612, 175, 174], [612, 176, 175], [177, 612, 611], [263, 105, 104], [263, 106, 105], [106, 263, 262], [612, 177, 176], [370, 325, 310], [325, 370, 369], [371, 310, 309], [310, 371, 370], [613, 173, 172], [613, 174, 173], [174, 613, 612], [264, 103, 102], [264, 104, 103], [104, 264, 263], [614, 172, 171], [372, 309, 308], [309, 372, 371], [521, 158, 157], [521, 159, 158], [159, 521, 520], [172, 614, 613], [615, 171, 170], [171, 615, 614], [522, 157, 156], [157, 522, 521], [450, 345, 346], [450, 436, 345], [436, 450, 449], [616, 170, 169], [170, 616, 615], [308, 373, 372], [523, 155, 154], [346, 451, 450], [523, 156, 155], [156, 523, 522], [308, 374, 373], [374, 308, 307], [169, 617, 616], [53, 56, 55], [56, 53, 52], [154, 524, 523], [524, 153, 152], [524, 154, 153], [619, 169, 168], [346, 452, 451], [617, 619, 618], [619, 617, 169], [102, 265, 264], [152, 525, 524], [525, 152, 151], [307, 375, 374], [375, 307, 306], [168, 620, 619], [620, 168, 167], [151, 526, 525], [526, 151, 150], [167, 621, 620], [621, 167, 166], [453, 346, 347], [346, 453, 452], [527, 149, 148], [150, 527, 526], [527, 150, 149], [166, 622, 621], [622, 165, 164], [622, 166, 165], [164, 623, 622], [623, 162, 161], [52, 57, 56], [57, 52, 51], [623, 163, 162], [148, 528, 527], [623, 164, 163], [528, 147, 146], [528, 148, 147], [454, 28, 27], [454, 347, 28], [347, 454, 453], [161, 624, 623], [624, 160, 159], [624, 161, 160], [529, 145, 144], [529, 146, 145], [146, 529, 528], [625, 520, 519], [625, 159, 520], [159, 625, 624], [626, 518, 517], [626, 519, 518], [519, 626, 625], [455, 27, 26], [27, 455, 454], [530, 143, 142], [530, 144, 143], [144, 530, 529], [627, 517, 516], [517, 627, 626], [628, 566, 357], [628, 567, 566], [628, 515, 567], [516, 628, 627], [628, 516, 515], [531, 142, 141], [142, 531, 530], [629, 357, 358], [357, 629, 628], [358, 599, 630], [51, 58, 57], [58, 51, 50], [456, 25, 24], [456, 26, 25], [26, 456, 455], [629, 358, 630], [352, 382, 381], [382, 352, 353], [24, 457, 456], [457, 24, 23], [353, 383, 382], [383, 353, 354], [458, 22, 21], [23, 458, 457], [458, 23, 22], [50, 59, 58], [59, 50, 49], [354, 384, 383], [385, 354, 355], [354, 385, 384], [233, 537, 234], [232, 537, 233], [21, 459, 458], [459, 21, 20], [20, 460, 459], [460, 20, 19], [49, 60, 59], [60, 49, 48], [355, 386, 385], [19, 461, 460], [461, 19, 18], [387, 355, 356], [355, 387, 386], [18, 462, 461], [462, 18, 17], [314, 87, 86], [314, 88, 87], [314, 86, 315], [85, 315, 86], [315, 85, 291], [463, 16, 15], [17, 463, 462], [463, 17, 16], [316, 313, 312], [316, 314, 313], [15, 464, 463], [464, 15, 14], [356, 388, 387], [89, 317, 90], [88, 317, 89], [317, 314, 316], [314, 317, 88], [465, 14, 13], [14, 465, 464], [92, 318, 93], [91, 318, 92], [318, 90, 317], [90, 318, 91], [466, 13, 12], [13, 466, 465], [356, 389, 388], [94, 319, 95], [93, 319, 94], [319, 93, 318], [467, 12, 11], [12, 467, 466], [544, 139, 138], [532, 544, 543], [544, 140, 139], [544, 141, 140], [141, 544, 531], [544, 532, 531], [96, 320, 97], [320, 95, 319], [95, 320, 96], [545, 250, 249], [545, 251, 250], [545, 137, 251], [545, 138, 137], [138, 545, 544], [468, 11, 10], [11, 468, 467], [99, 321, 100], [98, 321, 99], [97, 321, 98], [321, 97, 320], [546, 247, 246], [546, 248, 247], [546, 249, 248], [249, 546, 545], [265, 322, 266], [102, 322, 265], [469, 10, 9], [101, 322, 102], [10, 469, 468], [100, 322, 101], [322, 100, 321], [323, 266, 322], [547, 246, 245], [246, 547, 546], [548, 245, 244], [470, 8, 7], [310, 325, 311], [470, 9, 8], [9, 470, 469], [548, 244, 243], [312, 326, 316], [311, 325, 326], [326, 312, 311], [245, 548, 547], [41, 327, 42], [243, 549, 548], [549, 243, 242], [327, 43, 42], [327, 44, 43], [471, 7, 6], [7, 471, 470], [327, 45, 44], [551, 240, 239], [242, 550, 549], [550, 241, 240], [550, 242, 241], [327, 46, 45], [240, 551, 550], [6, 472, 471], [472, 6, 5], [552, 239, 238], [239, 552, 551], [236, 553, 237], [61, 328, 62], [60, 328, 61], [48, 328, 60], [47, 328, 48], [46, 328, 47], [328, 46, 327], [553, 238, 237], [238, 553, 552], [554, 236, 235], [234, 554, 235], [554, 234, 537], [236, 554, 553], [5, 473, 472], [473, 5, 4], [64, 329, 65], [62, 329, 63], [63, 329, 64], [329, 62, 328], [474, 3, 202], [474, 202, 201], [4, 474, 473], [474, 4, 3], [556, 401, 400], [68, 330, 69], [67, 330, 68], [475, 200, 199], [66, 330, 67], [330, 65, 329], [65, 330, 66], [201, 475, 474], [475, 201, 200], [400, 557, 556], [71, 331, 72], [70, 331, 71], [331, 69, 330], [69, 331, 70], [558, 400, 399], [400, 558, 557], [199, 476, 475], [296, 332, 297], [476, 199, 198], [74, 332, 296], [73, 332, 74], [332, 72, 331], [72, 332, 73], [559, 399, 398], [333, 297, 332], [298, 333, 299], [297, 333, 298], [398, 560, 559], [399, 559, 558], [560, 398, 397], [198, 477, 476], [334, 299, 333], [477, 198, 197], [561, 397, 396], [397, 561, 560], [562, 396, 395], [396, 562, 561], [563, 395, 394], [395, 563, 562], [197, 478, 477], [478, 197, 196], [564, 393, 392], [564, 394, 393], [394, 564, 563], [337, 41, 40], [41, 337, 327], [196, 479, 478], [479, 195, 194], [479, 196, 195], [565, 391, 390], [565, 392, 391], [392, 565, 564], [566, 356, 357], [390, 566, 565], [566, 389, 356], [566, 390, 389], [194, 480, 479], [338, 32, 31], [338, 34, 33], [338, 33, 32], [338, 35, 34], [480, 194, 193], [38, 339, 39], [567, 515, 514], [37, 339, 38], [36, 339, 37], [35, 339, 36], [339, 35, 338], [337, 340, 336], [514, 568, 567], [40, 340, 337], [39, 340, 40], [340, 39, 339], [568, 514, 513], [193, 481, 480], [481, 193, 192], [513, 569, 568], [336, 341, 335], [341, 336, 340], [482, 192, 191], [342, 335, 341], [192, 482, 481], [513, 570, 569], [570, 513, 512], [281, 217, 216], [483, 191, 190], [191, 483, 482], [512, 571, 570], [536, 572, 571], [273, 406, 405], [406, 273, 272], [407, 272, 271], [572, 536, 535], [282, 215, 214], [216, 282, 281], [282, 216, 215], [272, 407, 406], [571, 512, 536], [408, 271, 270], [271, 408, 407], [484, 190, 189], [190, 484, 483], [214, 283, 282], [283, 213, 212], [283, 214, 213], [535, 573, 572], [410, 269, 268], [409, 270, 269], [270, 409, 408], [534, 574, 573], [269, 410, 409], [486, 187, 186], [486, 188, 187], [485, 189, 188], [189, 485, 484], [188, 486, 485], [212, 284, 283], [573, 535, 534], [284, 211, 210], [284, 212, 211], [411, 268, 267], [268, 411, 410], [267, 363, 412], [411, 267, 412], [285, 122, 121], [285, 123, 122], [210, 285, 284], [285, 210, 123], [413, 304, 303], [534, 575, 574], [487, 186, 185], [186, 487, 486], [121, 286, 285], [286, 120, 119], [286, 121, 120], [575, 534, 533], [119, 287, 286], [287, 118, 117], [287, 119, 118], [488, 185, 184], [185, 488, 487], [577, 543, 542], [533, 576, 575], [576, 532, 543], [576, 533, 532], [117, 288, 287], [289, 116, 115], [288, 117, 116], [116, 289, 288], [543, 577, 576], [290, 113, 258], [113, 290, 114], [290, 115, 114], [115, 290, 289], [414, 304, 413], [84, 83, 291], [28, 347, 29], [347, 30, 29], [184, 489, 488], [183, 490, 489], [490, 183, 182], [415, 305, 414], [489, 184, 183], [579, 541, 540], [578, 542, 541], [542, 578, 577], [581, 539, 538], [580, 540, 539], [347, 31, 30], [31, 347, 338], [540, 580, 579], [541, 579, 578], [181, 491, 490], [416, 305, 415], [304, 414, 305], [490, 182, 181], [306, 416, 375], [539, 581, 580], [202, 3, 2], [538, 582, 581], [375, 417, 376], [2, 203, 202], [203, 2, 1], [1, 204, 203], [204, 1, 0], [491, 181, 180], [583, 538, 537], [128, 205, 129], [584, 231, 230], [127, 205, 128], [305, 416, 306], [584, 230, 229], [417, 375, 416], [538, 583, 582], [584, 232, 231], [584, 537, 232], [537, 584, 583], [291, 85, 84], [377, 419, 378], [376, 418, 377], [418, 376, 417], [419, 377, 418], [378, 420, 379], [587, 404, 403], [420, 378, 419], [587, 405, 404], [587, 273, 405], [273, 587, 274], [206, 127, 126], [127, 206, 205], [421, 381, 380], [381, 421, 352], [379, 421, 380], [421, 379, 420], [588, 274, 587], [274, 588, 275], [589, 275, 588], [352, 422, 351], [422, 352, 421], [126, 207, 206], [207, 126, 125], [276, 589, 277], [275, 589, 276], [83, 292, 291], [590, 277, 589], [292, 83, 82], [277, 590, 278], [351, 423, 350], [423, 351, 422], [591, 278, 590], [498, 361, 362], [350, 424, 349], [424, 350, 423], [125, 208, 207], [208, 125, 124], [278, 591, 279], [362, 499, 498], [137, 252, 251], [252, 137, 136], [592, 279, 591], [293, 81, 80], [82, 293, 292], [293, 82, 81], [217, 592, 218], [592, 281, 280], [136, 253, 252], [253, 136, 135], [592, 217, 281], [279, 592, 280], [425, 349, 424], [135, 254, 253], [254, 135, 134], [294, 79, 78], [294, 80, 79], [80, 294, 293], [500, 362, 348], [209, 124, 123], [124, 209, 208], [134, 255, 254], [362, 500, 499], [255, 134, 133], [133, 256, 255], [221, 593, 222], [256, 133, 132], [131, 130, 257], [220, 593, 221], [257, 132, 131], [132, 257, 256], [219, 593, 220], [218, 593, 219], [593, 218, 592], [348, 501, 500], [584, 595, 585], [349, 426, 348], [426, 349, 425], [222, 594, 223], [224, 594, 225], [223, 594, 224], [594, 222, 593], [502, 426, 427], [502, 348, 426], [348, 502, 501], [228, 595, 229], [229, 595, 584], [227, 595, 228], [226, 595, 227], [595, 225, 594], [225, 595, 226], [123, 210, 209], [585, 596, 586], [503, 427, 428], [427, 503, 502], [596, 585, 595], [401, 597, 402], [556, 597, 401], [555, 597, 556], [295, 76, 75], [258, 113, 112], [295, 77, 76], [295, 78, 77], [78, 295, 294], [586, 597, 555], [597, 586, 596], [598, 402, 597], [587, 403, 598], [504, 428, 429], [428, 504, 503], [505, 429, 430], [429, 505, 504], [402, 598, 403], [506, 430, 431], [430, 506, 505], [359, 599, 358], [431, 507, 506], [507, 431, 432], [259, 112, 111], [112, 259, 258]]
    delaunay_mesh = Mesh.from_vertices_and_faces(vertices, face_vertices)

    medial_branches = delaunay_to_qpd(delaunay_mesh)

    print medial_branches
